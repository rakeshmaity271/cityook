!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){var e={options:{optionClass:"",dropdownClass:"",autoinit:!1,callback:!1,onSelected:!1,dynamicOptLabel:"Add a new option..."},init:function(n){function o(o){if(!o.data("dropdownjs")&&o.is("select")){var a=o.attr("multiple"),d=o.attr("data-dynamic-opts"),i=t(),s=t("<div></div>");s.addClass("dropdownjs").addClass(n.dropdownStyle),s.data("select",o);var l=t("<input type=text readonly class=fakeinput style='padding: 10px;'>");t.material&&l.data("mdproc",!0),s.append(l);var r=t("<ul></ul>");r.data("select",o),s.append(r),l.attr("placeholder",o.attr("placeholder")),o.find("option").each(function(){var n=t(this);e._addOption(r,n)}),d&&(i=t("<li class=dropdownjs-add></li>"),i.append("<input>"),i.find("input").attr("placeholder",n.dynamicOptLabel),r.append(i));s.find("li");if(a){var c=[],p=o.val();for(var f in p)c.push("li[value="+p[f]+"]");c.length>0&&e._select(s,s.find(c.join(",")))}else{var u;u=o.find(":selected").length?o.find(":selected").last():o.find("option, li").first(),e._select(s,u)}l.addClass(o[0].className),o.hide().attr("data-dropdownjs",!0),o.after(s),n.callback&&n.callback(s),r.on("click","li:not(.dropdownjs-add)",function(n){e._select(s,t(this)),o.change()}),r.on("keydown","li:not(.dropdownjs-add)",function(n){return 27===n.which?(t(".dropdownjs > ul > li").attr("tabindex",-1),l.removeClass("focus").blur()):32!==n.which||t(n.target).is("input")?void 0:(e._select(s,t(this)),!1)}),r.on("focus","li:not(.dropdownjs-add)",function(){o.is(":disabled")||l.addClass("focus")}),d&&d.length&&i.on("keydown",function(e){if(13===e.which){var n=t("<option>"),a=i.find("input").val();i.find("input").val(""),n.attr("value",a),n.text(a),o.append(n)}}),o.on("DOMNodeInserted",function(n){var o=t(n.target);o.val().length&&(e._addOption(r,o),r.find("li").not(".dropdownjs-add").attr("tabindex",0))}),o.on("change",function(n){var d=t(n.target);if(d.val().length)if(a)e._select(s,o.find(":selected"));else{var i;i=o.find(":selected").length?o.find(":selected").last():o.find("option, li").first(),e._select(s,i)}}),l.on("click focus",function(e){if(e.stopPropagation(),!o.is(":disabled")){t(".dropdownjs > ul > li").attr("tabindex",-1),t(".dropdownjs > input").not(t(this)).removeClass("focus").blur(),t(".dropdownjs > ul > li").not(".dropdownjs-add").attr("tabindex",0);var n={top:t(this).offset().top-t(document).scrollTop(),left:t(this).offset().left-t(document).scrollLeft(),bottom:t(window).height()-(t(this).offset().top-t(document).scrollTop()),right:t(window).width()-(t(this).offset().left-t(document).scrollLeft())},a=n.bottom;200>a&&n.top>n.bottom?(a=n.top,r.attr("placement","top-left")):r.attr("placement","bottom-left"),t(this).next("ul").css("max-height",a-20),t(this).addClass("focus")}}),t(document).on("click",function(e){a&&t(e.target).parents(".dropdownjs").length||t(e.target).parents(".dropdownjs-add").length||t(e.target).is(".dropdownjs-add")||(t(".dropdownjs > ul > li").attr("tabindex",-1),l.removeClass("focus"))})}}n=n?t.extend(e.options,n):e.options,n.autoinit&&t(document).on("DOMNodeInserted",function(e){var a=t(e.target);a.is("select")||(a=a.find("select")),a.is(n.autoinit)&&a.each(function(){o(t(this))})}),t(this).each(function(){o(t(this))})},select:function(n){var o=t(this).find('[value="'+n+'"]');e._select(t(this),o)},_select:function(e,n){if(!n.is(".dropdownjs-add")){var o=e.data("select"),a=e.find("input.fakeinput"),d=o.attr("multiple"),i=e.find("li");if(d){n.toggleClass("selected"),n.each(function(){var e=o.find('[value="'+t(this).attr("value")+'"]');e.prop("selected",t(this).hasClass("selected"))});var s=[];i.each(function(){t(this).hasClass("selected")&&s.push(t(this).text())}),a.val(s.join(", "))}d||(n.is("li")&&i.not(n).removeClass("selected"),n.addClass("selected"),o.val(n.attr("value")),a.val(n.text().trim())),t.material&&(a.val().trim()?o.removeClass("empty"):o.addClass("empty")),this.options.onSelected&&this.options.onSelected(n.attr("value"))}},_addOption:function(e,n){var o=t("<li></li>");o.addClass(this.options.optionStyle),n.text()?o.text(n.text()):o.html("&nbsp;"),o.attr("value",n.val()),e.data("select").attr("data-dynamic-opts")&&(o.append("<span class=close></span>"),o.find(".close").on("click",function(){o.remove(),n.remove()})),n.prop("selected")&&(o.attr("selected",!0),o.addClass("selected")),e.find(".dropdownjs-add").length?e.find(".dropdownjs-add").before(o):e.append(o)}};t.fn.dropdown=function(n){return e[n]?e[n].apply(this,Array.prototype.slice.call(arguments,1)):"object"==typeof n|!n?e.init.apply(this,arguments):void t.error("Method "+n+" does not exists on jQuery.dropdown")}});